<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<head>
    <title>Reference</title>
    <link rel="stylesheet" href="ldoc.css" type="text/css" />
</head>
<body>

<div id="container">

<div id="product">
	<div id="product_logo"></div>
	<div id="product_name"><big><b></b></big></div>
	<div id="product_description"></div>
</div> <!-- id="product" -->


<div id="main">


<!-- Menu -->

<div id="navigation">
<br/>
<h1>lua-yottadb</h1>


<h2>Modules</h2>
<ul class="nowrap">
  <li><strong>yottadb</strong></li>
</ul>
<h2>Contents</h2>
<ul>
<li><a href=""><b>Summary</b></a></li>
<br/>
<li><a href="#Functions"><b>Functions</b></a></li>
    <li><a href="#data">data (varname[, subsarray])</a></li>
    <li><a href="#delete_node">delete_node (varname[, subsarray])</a></li>
    <li><a href="#delete_tree">delete_tree (varname[, subsarray])</a></li>
    <li><a href="#get">get (varname[, ...])</a></li>
    <li><a href="#get_error_code">get_error_code (message)</a></li>
    <li><a href="#incr">incr (varname[, subsarray], increment)</a></li>
    <li><a href="#lock">lock ([nodes[, timeout]])</a></li>
    <li><a href="#lock_decr">lock_decr (varname[, subsarray])</a></li>
    <li><a href="#lock_incr">lock_incr (varname[, subsarray], timeout)</a></li>
    <li><a href="#node_next">node_next (varname[, subsarray])</a></li>
    <li><a href="#node_previous">node_previous (varname[, subsarray])</a></li>
    <li><a href="#nodes">nodes (varname[, subsarray], reverse)</a></li>
    <li><a href="#set">set (varname[, subsarray], value)</a></li>
    <li><a href="#str2zwr">str2zwr (s)</a></li>
    <li><a href="#subscript_next">subscript_next (varname[, subsarray])</a></li>
    <li><a href="#subscript_previous">subscript_previous (varname[, subsarray])</a></li>
    <li><a href="#subscripts">subscripts (varname[, subsarray], reverse)</a></li>
    <li><a href="#zwr2str">zwr2str (s)</a></li>
<br/>
<li><a href="#High_level_functions"><b>High level functions </b></a></li>
    <li><a href="#dump">dump (node, maxlines)</a></li>
    <li><a href="#node:gettree">node:gettree ([maxdepth[, filter[, _value[, _depth]]]])</a></li>
    <li><a href="#node:settree">node:settree (tbl[, filter[, _seen]])</a></li>
<br/>
<li><a href="#Transactions"><b>Transactions </b></a></li>
    <li><a href="#tp">tp (id, varnames, f[, ...])</a></li>
    <li><a href="#transaction">transaction ([id][, varnames], f)</a></li>
    <li><a href="#trestart">trestart ()</a></li>
    <li><a href="#trollback">trollback ()</a></li>
<br/>
<li><a href="#Node_object_creation"><b>Node object creation </b></a></li>
    <li><a href="#key">key (varname[, subsarray])</a></li>
    <li><a href="#node">node (varname[, subsarray])</a></li>
<br/>
<li><a href="#Class_node"><b>Class node </b></a></li>
    <li><a href="#node:delete_node">node:delete_node ()</a></li>
    <li><a href="#node:delete_tree">node:delete_tree ()</a></li>
    <li><a href="#node:get">node:get ([default])</a></li>
    <li><a href="#node:incr">node:incr (value)</a></li>
    <li><a href="#node:lock">node:lock (timeout)</a></li>
    <li><a href="#node:lock_decr">node:lock_decr ()</a></li>
    <li><a href="#node:lock_incr">node:lock_incr (timeout)</a></li>
    <li><a href="#node:set">node:set (value)</a></li>
    <li><a href="#node:subscripts">node:subscripts ([reverse])</a></li>
<br/>
<li><a href="#Get_node_properties"><b>Get node properties </b></a></li>
    <li><a href="#node:data">node:data ()</a></li>
    <li><a href="#node:has_tree">node:has_tree ()</a></li>
    <li><a href="#node:has_value">node:has_value ()</a></li>
    <li><a href="#node:name">node:name ()</a></li>
<br/>
<li><a href="#Class_key"><b>Class key </b></a></li>
    <li><a href="#key.property">key.property</a></li>
    <li><a href="#key:subscript_next">key:subscript_next ([reset])</a></li>
    <li><a href="#key:subscript_previous">key:subscript_previous ([reset])</a></li>
    <li><a href="#key:subscripts">key:subscripts ([reverse])</a></li>


</ul>



</div>

<div id="content">

<h1>Module <code>yottadb</code></h1>
<p>Lua-bindings for YottaDB, sponsored by the <a href="https://www.uantwerpen.be/en/library/">University of Antwerp Library</a></p>
<p>

</p>


<h2><a href="#Functions">Functions</a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#data">data (varname[, subsarray])</a></td>
	<td class="summary">Get information about a variable/node (except intrinsic variables).</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#delete_node">delete_node (varname[, subsarray])</a></td>
	<td class="summary">Deletes the value of a single database variable/node.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#delete_tree">delete_tree (varname[, subsarray])</a></td>
	<td class="summary">Deletes a database variable/node tree/subtree.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#get">get (varname[, ...])</a></td>
	<td class="summary">Gets and returns the value of a database variable/node, or <code>nil</code> if the variable/node does not exist.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#get_error_code">get_error_code (message)</a></td>
	<td class="summary">Get the YDB error code (if any) contained in the given error message.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#incr">incr (varname[, subsarray], increment)</a></td>
	<td class="summary">Increments the numeric value of a database variable/node.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#lock">lock ([nodes[, timeout]])</a></td>
	<td class="summary">Releases all locks held and attempts to acquire all requested locks, waiting if requested.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#lock_decr">lock_decr (varname[, subsarray])</a></td>
	<td class="summary">Decrements a lock of the same name as {varname, subsarray}, releasing it if possible.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#lock_incr">lock_incr (varname[, subsarray], timeout)</a></td>
	<td class="summary">Attempts to acquire or increment a lock of the same name as {varname, subsarray}, waiting if requested.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#node_next">node_next (varname[, subsarray])</a></td>
	<td class="summary">Returns the next node for a database variable/node, or <code>nil</code> if there isn't one.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#node_previous">node_previous (varname[, subsarray])</a></td>
	<td class="summary">Returns the previous node for a database variable/node, or <code>nil</code> if there isn't one.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#nodes">nodes (varname[, subsarray], reverse)</a></td>
	<td class="summary">Returns an iterator for iterating over all nodes in a database variable/node.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#set">set (varname[, subsarray], value)</a></td>
	<td class="summary">Sets the value of a database variable/node.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#str2zwr">str2zwr (s)</a></td>
	<td class="summary">Returns the zwrite-formatted version of the given string.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#subscript_next">subscript_next (varname[, subsarray])</a></td>
	<td class="summary">Returns the next subscript for a database variable/node, or <code>nil</code> if there isn't one.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#subscript_previous">subscript_previous (varname[, subsarray])</a></td>
	<td class="summary">Returns the previous subscript for a database variable/node, or <code>nil</code> if there isn't one.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#subscripts">subscripts (varname[, subsarray], reverse)</a></td>
	<td class="summary">Returns an iterator for iterating over all subscripts in a database variable/node.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#zwr2str">zwr2str (s)</a></td>
	<td class="summary">Returns the string described by the given zwrite-formatted string.</td>
	</tr>
</table>
<h2><a href="#High_level_functions">High level functions </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#dump">dump (node, maxlines)</a></td>
	<td class="summary">Dump the specified node and its children</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#node:gettree">node:gettree ([maxdepth[, filter[, _value[, _depth]]]])</a></td>
	<td class="summary">Fetch database node and subtree and return a Lua table of it.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#node:settree">node:settree (tbl[, filter[, _seen]])</a></td>
	<td class="summary">Populate database from a table.</td>
	</tr>
</table>
<h2><a href="#Transactions">Transactions </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#tp">tp (id, varnames, f[, ...])</a></td>
	<td class="summary">Initiates a transaction.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#transaction">transaction ([id][, varnames], f)</a></td>
	<td class="summary">Returns a transaction-safed version of the given function such that it will be called within
   a yottadb transaction and the dbase globals restored on error or rollback()</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#trestart">trestart ()</a></td>
	<td class="summary">Make the currently running transaction function restart immediately.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#trollback">trollback ()</a></td>
	<td class="summary">Make the currently running transaction function rollback immediately and produce a rollback error.</td>
	</tr>
</table>
<h2><a href="#Node_object_creation">Node object creation </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#key">key (varname[, subsarray])</a></td>
	<td class="summary">Deprecated object that represents a YDB node.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#node">node (varname[, subsarray])</a></td>
	<td class="summary">Creates and returns a new YottaDB node object.</td>
	</tr>
</table>
<h2><a href="#Class_node">Class node </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#node:delete_node">node:delete_node ()</a></td>
	<td class="summary">Delete database node pointed to by node object</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#node:delete_tree">node:delete_tree ()</a></td>
	<td class="summary">Delete database tree pointed to by node object</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#node:get">node:get ([default])</a></td>
	<td class="summary">Get node's value.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#node:incr">node:incr (value)</a></td>
	<td class="summary">Increment node's value</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#node:lock">node:lock (timeout)</a></td>
	<td class="summary">Releases all locks held and attempts to acquire a lock matching this node, waiting if requested.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#node:lock_decr">node:lock_decr ()</a></td>
	<td class="summary">Decrements a lock matching this node, releasing it if possible.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#node:lock_incr">node:lock_incr (timeout)</a></td>
	<td class="summary">Attempts to acquire or increment a lock matching this node, waiting if requested.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#node:set">node:set (value)</a></td>
	<td class="summary">Set node's value.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#node:subscripts">node:subscripts ([reverse])</a></td>
	<td class="summary">Return iterator over the child subscripts of a node (in M terms, collate from "" to "").</td>
	</tr>
</table>
<h2><a href="#Get_node_properties">Get node properties </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#node:data">node:data ()</a></td>
	<td class="summary">Fetch the 'data' flags of the node @see data</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#node:has_tree">node:has_tree ()</a></td>
	<td class="summary">Return true if the node has a tree; otherwise false</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#node:has_value">node:has_value ()</a></td>
	<td class="summary">Return true if the node has a value; otherwise false</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#node:name">node:name ()</a></td>
	<td class="summary">Fetch the name of the node, i.e.</td>
	</tr>
</table>
<h2><a href="#Class_key">Class key </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#key.property">key.property</a></td>
	<td class="summary">Properties of key object</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#key:subscript_next">key:subscript_next ([reset])</a></td>
	<td class="summary">Deprecated way to get next subscript.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#key:subscript_previous">key:subscript_previous ([reset])</a></td>
	<td class="summary">Deprecated way to get previous subscript.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#key:subscripts">key:subscripts ([reverse])</a></td>
	<td class="summary">Deprecated way to get same-level subscripts from this node onward.</td>
	</tr>
</table>

<br/>
<br/>


    <h2 class="section-header "><a name="Functions"></a>Functions</h2>

    <dl class="function">
    <dt>
    <a name = "data"></a>
    <strong>data (varname[, subsarray])</strong>
    </dt>
    <dd>
    Get information about a variable/node (except intrinsic variables).


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">varname</span>
         String variable name.
        </li>
        <li><span class="parameter">subsarray</span>
         list of subscripts or table {subscripts}.
         (<em>optional</em>)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>
        <li>
        yottadb.YDB<em>DATA</em>UNDEF (no value or subtree)</li>
        <li>
        or yottadb.YDB<em>DATA</em>VALUE_NODESC (value, no subtree)</li>
        <li>
        or yottadb.YDB<em>DATA</em>NOVALUE_DESC (no value, subtree)</li>
        <li>
        or yottadb.YDB<em>DATA</em>VALUE_NODESC (value and subtree)</li>
    </ol>




</dd>
    <dt>
    <a name = "delete_node"></a>
    <strong>delete_node (varname[, subsarray])</strong>
    </dt>
    <dd>
    Deletes the value of a single database variable/node.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">varname</span>
         String variable name.
        </li>
        <li><span class="parameter">subsarray</span>
         list of subscripts or table {subscripts}.
         (<em>optional</em>)
        </li>
    </ul>





</dd>
    <dt>
    <a name = "delete_tree"></a>
    <strong>delete_tree (varname[, subsarray])</strong>
    </dt>
    <dd>
    Deletes a database variable/node tree/subtree.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">varname</span>
         String variable name.
        </li>
        <li><span class="parameter">subsarray</span>
         list of subscripts or table {subscripts}.
         (<em>optional</em>)
        </li>
    </ul>





</dd>
    <dt>
    <a name = "get"></a>
    <strong>get (varname[, ...])</strong>
    </dt>
    <dd>
    Gets and returns the value of a database variable/node, or <code>nil</code> if the variable/node does not exist.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">varname</span>
         String variable name.
        </li>
        <li><span class="parameter">...</span>
         list of subscripts or table {subscripts}
         (<em>optional</em>)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        string value or <code>nil</code>
    </ol>




</dd>
    <dt>
    <a name = "get_error_code"></a>
    <strong>get_error_code (message)</strong>
    </dt>
    <dd>
    Get the YDB error code (if any) contained in the given error message.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">message</span>
         String error message.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>
        <li>
        the YDB error code (if any) for the given error message,</li>
        <li>
        or <code>nil</code> if the message is not a YDB error.</li>
    </ol>




</dd>
    <dt>
    <a name = "incr"></a>
    <strong>incr (varname[, subsarray], increment)</strong>
    </dt>
    <dd>
    Increments the numeric value of a database variable/node.
 Raises an error on overflow.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">varname</span>
         String variable name.
        </li>
        <li><span class="parameter">subsarray</span>
         list of subscripts or table {subscripts}.
         (<em>optional</em>)
        </li>
        <li><span class="parameter">increment</span>
         String or number amount to increment by.
  Optional only if subsarray is a table.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        the new value
    </ol>




</dd>
    <dt>
    <a name = "lock"></a>
    <strong>lock ([nodes[, timeout]])</strong>
    </dt>
    <dd>
    Releases all locks held and attempts to acquire all requested locks, waiting if requested.
 Returns 0 (always).
 Raises an error yottadb.YDB<em>LOCK</em>TIMEOUT if a lock could not be acquired.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">nodes</span>
         list containing {varname[, subs]} or node objects that specify the lock names to lock.
         (<em>optional</em>)
        </li>
        <li><span class="parameter">timeout</span>
         timeout in seconds to wait for the lock.
         (<em>optional</em>)
        </li>
    </ul>





</dd>
    <dt>
    <a name = "lock_decr"></a>
    <strong>lock_decr (varname[, subsarray])</strong>
    </dt>
    <dd>
    Decrements a lock of the same name as {varname, subsarray}, releasing it if possible.
 Returns 0 (always).
 Releasing a lock cannot create an error unless the varname/subsarray names are invalid.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">varname</span>
         String variable name.
        </li>
        <li><span class="parameter">subsarray</span>
         list of subscripts or table {subscripts}.
         (<em>optional</em>)
        </li>
    </ul>





</dd>
    <dt>
    <a name = "lock_incr"></a>
    <strong>lock_incr (varname[, subsarray], timeout)</strong>
    </dt>
    <dd>
    Attempts to acquire or increment a lock of the same name as {varname, subsarray}, waiting if requested.
 Returns 0 (always)
 Raises a error yottadb.YDB<em>LOCK</em>TIMEOUT if a lock could not be acquired.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">varname</span>
         String variable name.
        </li>
        <li><span class="parameter">subsarray</span>
         list of subscripts or table {subscripts}.
         (<em>optional</em>)
        </li>
        <li><span class="parameter">timeout</span>
         Seconds to wait for the lock.
  Optional only if subscripts is a table.
        </li>
    </ul>





</dd>
    <dt>
    <a name = "node_next"></a>
    <strong>node_next (varname[, subsarray])</strong>
    </dt>
    <dd>
    Returns the next node for a database variable/node, or <code>nil</code> if there isn't one.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">varname</span>
         String variable name.
        </li>
        <li><span class="parameter">subsarray</span>
         list of subscripts or table {subscripts}.
         (<em>optional</em>)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        list of subscripts for the node, or nil
    </ol>




</dd>
    <dt>
    <a name = "node_previous"></a>
    <strong>node_previous (varname[, subsarray])</strong>
    </dt>
    <dd>
    Returns the previous node for a database variable/node, or <code>nil</code> if there isn't one.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">varname</span>
         String variable name.
        </li>
        <li><span class="parameter">subsarray</span>
         list of subscripts or table {subscripts}.
         (<em>optional</em>)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        list of subscripts for the node, or nil
    </ol>




</dd>
    <dt>
    <a name = "nodes"></a>
    <strong>nodes (varname[, subsarray], reverse)</strong>
    </dt>
    <dd>
    Returns an iterator for iterating over all nodes in a database variable/node.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">varname</span>
         String variable name.
        </li>
        <li><span class="parameter">subsarray</span>
         list of subscripts or table {subscripts}
         (<em>optional</em>)
        </li>
        <li><span class="parameter">reverse</span>
         Flag that indicates whether to iterate backwards.
   Optional only if subscripts is a table.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        iterator
    </ol>



    <h3>Usage:</h3>
    <ul>
        <pre class="example"><span class="keyword">for</span> node_subscripts <span class="keyword">in</span> yottadb.nodes(varname, subsarray) <span class="keyword">do</span> ... <span class="keyword">end</span></pre>
    </ul>

</dd>
    <dt>
    <a name = "set"></a>
    <strong>set (varname[, subsarray], value)</strong>
    </dt>
    <dd>
    Sets the value of a database variable/node.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">varname</span>
         String variable name.
        </li>
        <li><span class="parameter">subsarray</span>
         list of subscripts or table {subscripts}.
         (<em>optional</em>)
        </li>
        <li><span class="parameter">value</span>
         String value to set. If this is a number, it is converted to a string.
        </li>
    </ul>





</dd>
    <dt>
    <a name = "str2zwr"></a>
    <strong>str2zwr (s)</strong>
    </dt>
    <dd>
    Returns the zwrite-formatted version of the given string.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">s</span>
         String to format.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        formatted string
    </ol>




</dd>
    <dt>
    <a name = "subscript_next"></a>
    <strong>subscript_next (varname[, subsarray])</strong>
    </dt>
    <dd>
    Returns the next subscript for a database variable/node, or <code>nil</code> if there isn't one.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">varname</span>
         String variable name.
        </li>
        <li><span class="parameter">subsarray</span>
         list of subscripts or table {subscripts}.
         (<em>optional</em>)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        string subscript name or nil
    </ol>




</dd>
    <dt>
    <a name = "subscript_previous"></a>
    <strong>subscript_previous (varname[, subsarray])</strong>
    </dt>
    <dd>
    Returns the previous subscript for a database variable/node, or <code>nil</code> if there isn't one.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">varname</span>
         String variable name.
        </li>
        <li><span class="parameter">subsarray</span>
         list of subscripts or table {subscripts}.
         (<em>optional</em>)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        string subscript name or nil
    </ol>




</dd>
    <dt>
    <a name = "subscripts"></a>
    <strong>subscripts (varname[, subsarray], reverse)</strong>
    </dt>
    <dd>
    Returns an iterator for iterating over all subscripts in a database variable/node.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">varname</span>
         String variable name.
        </li>
        <li><span class="parameter">subsarray</span>
         list of subscripts or table {subscripts}
         (<em>optional</em>)
        </li>
        <li><span class="parameter">reverse</span>
         Flag that indicates whether to iterate backwards.
   Optional only if subscripts is a table.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        iterator
    </ol>



    <h3>Usage:</h3>
    <ul>
        <pre class="example"><span class="keyword">for</span> name <span class="keyword">in</span> yottadb.subscripts(varname, subsarray) <span class="keyword">do</span> ... <span class="keyword">end</span></pre>
    </ul>

</dd>
    <dt>
    <a name = "zwr2str"></a>
    <strong>zwr2str (s)</strong>
    </dt>
    <dd>
    Returns the string described by the given zwrite-formatted string.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">s</span>
         String in zwrite format.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        string
    </ol>




</dd>
</dl>
    <h2 class="section-header "><a name="High_level_functions"></a>High level functions </h2>

    <dl class="function">
    <dt>
    <a name = "dump"></a>
    <strong>dump (node, maxlines)</strong>
    </dt>
    <dd>
    Dump the specified node and its children


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">node</span>
         Either a node object with <code>...</code> subscripts or glvn varname with <code>...</code> subsarray
        </li>
        <li><span class="parameter">maxlines</span>
         Maximum number of lines to output before stopping dump
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        dump as a string
    </ol>



    <h3>Usage:</h3>
    <ul>
        <pre class="example">: ydb.dump(node, {subsarray, ...}[, maxlines])  OR  ydb.dump(node, sub1, sub2, ...)</pre>
    </ul>

</dd>
    <dt>
    <a name = "node:gettree"></a>
    <strong>node:gettree ([maxdepth[, filter[, _value[, _depth]]]])</strong>
    </dt>
    <dd>
    Fetch database node and subtree and return a Lua table of it.  But be aware that order is not preserved by Lua tables.
 In its simplest form:</p>
<pre><code>  t = node:gettree({_='berwyn', weight=78, ['!@#$']='junk', appearance={_='handsome', eyes='blue', hair='blond'}, age=49})
</code></pre>
<p>  Note: special field name _ indicates the value of the node itself


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">maxdepth</span>
         subscript depth to fetch (nil=infinite; 1 fetches first layer of subscript's values only)
         (<em>optional</em>)
        </li>
        <li><span class="parameter">filter</span>

<p> function(node, node_subscript, value, recurse, depth) or nil</p>

<ul>
    <li>if filter is nil, all values are fetched unfiltered</li>
    <li>if filter is a function(node, node_subscript, value, recurse, depth) it is invoked on every subscript
    to allow it to cast/alter every _value and recurse flag;
    note that at node root (depth=0), subscript passed to filter is ''</li>
    <li>it must return the same or an altered _value (string/number/nil) and recurse flag</li>
    <li>if filter returns a nil _value then _gettree will store nothing in the table for that database value</li>
    <li>if filter return false recurse flag, it will prevent recursion deeper into that particular subscript</li>
</ul>

         (<em>optional</em>)
        </li>
        <li><span class="parameter">_value</span>
         is for internal use only (to avoid duplicate value fetches, for speed)
         (<em>optional</em>)
        </li>
        <li><span class="parameter">_depth</span>
         is for internal use only (to record depth of recursion) and must start unspecified (nil)
         (<em>optional</em>)
        </li>
    </ul>





</dd>
    <dt>
    <a name = "node:settree"></a>
    <strong>node:settree (tbl[, filter[, _seen]])</strong>
    </dt>
    <dd>

<p>Populate database from a table.  In its simpest form:</p>
<pre><code>node:settree({_='berwyn', weight=78, ['!@#$']='junk', appearance={_='handsome', eyes='blue', hair='blond'}, age=yottadb.DELETE})
</code></pre>



    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">tbl</span>

<p> is the table to store into the database:</p>

<ul>
    <li>special field name <code>_</code> sets the value of the node itself, as opposed to a subnode</li>
    <li>assign special value <code>yottadb.DELETE</code> to a node to delete the value of the node. You cannot delete the whole subtree</li>
</ul>

        </li>
        <li><span class="parameter">filter</span>

<p> function(node, key, value) or nil</p>

<ul>
    <li>if filter is nil, all values are set unfiltered</li>
    <li>if filter is a function(node, key, value) it is invoked on every node
    to allow it to cast/alter every key name and value</li>
    <li>filter must return the same or altered: key, value</li>
    <li>type errors can be handled (or ignored) using this function, too.</li>
    <li>if filter returns yottadb.DELETE as value, the key is deleted</li>
    <li>if filter returns nil as key or value, settree will simply not update the current database value</li>
</ul>

         (<em>optional</em>)
        </li>
        <li><span class="parameter">_seen</span>
         is for internal use only (to prevent accidental duplicate sets: bad because order setting is not guaranteed)
         (<em>optional</em>)
        </li>
    </ul>





</dd>
</dl>
    <h2 class="section-header "><a name="Transactions"></a>Transactions </h2>

    <dl class="function">
    <dt>
    <a name = "tp"></a>
    <strong>tp (id, varnames, f[, ...])</strong>
    </dt>
    <dd>
    Initiates a transaction.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">id</span>
        [opt] string transaction id. For special ids <code>BA</code> or <code>BATCH</code>, see <a href="https://docs.yottadb.com/ProgrammersGuide/langfeat.html#transaction-processing">ydb docs here</a>.
        </li>
        <li><span class="parameter">varnames</span>
        [opt] table of local M variable names to restore on transaction restart
   (or <code>{&apos;*&apos;}</code> for all locals) -- restoration does apply to rollback
        </li>
        <li><span class="parameter">f</span>
         Function to call. The transaction's affected globals are committed if the function returns nothing or
   <code>yottadb.YDB_OK</code>; restarted if the function returns <code>yottadb.YDB_TP_RESTART</code> (<code>f</code> will be called
   again); or not committed if the function returns <code>yottadb.YDB_TP_ROLLBACK</code> or errors.
   Note: restarts are subject to <code>$ZMAXTPTIME</code> after which they cause error <code>%YDB-E-TPTIMEOUT</code>
        </li>
        <li><span class="parameter">...</span>
         arguments to pass to <code>f</code>.
         (<em>optional</em>)
        </li>
    </ul>





</dd>
    <dt>
    <a name = "transaction"></a>
    <strong>transaction ([id][, varnames], f)</strong>
    </dt>
    <dd>
    Returns a transaction-safed version of the given function such that it will be called within
   a yottadb transaction and the dbase globals restored on error or rollback()


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">id</span>
         string transaction id. For special ids <code>BA</code> or <code>BATCH</code>, see <a href="https://docs.yottadb.com/ProgrammersGuide/langfeat.html#transaction-processing">ydb docs here</a>.
         (<em>optional</em>)
        </li>
        <li><span class="parameter">varnames</span>
         table of local M variable names to restore on transaction restart
   (or <code>{&apos;*&apos;}</code> for all locals) -- restoration does apply to rollback
         (<em>optional</em>)
        </li>
        <li><span class="parameter">f</span>
         Function to convert. The transaction's affected globals are committed if the function returns nothing
   or <code>yottadb.YDB_OK</code>; restarted if the function returns <code>yottadb.YDB_TP_RESTART</code> (<code>f</code> will be
   called again); or not committed if the function returns <code>yottadb.YDB_TP_ROLLBACK</code> or errors.
   Note: restarts are subject to <code>$ZMAXTPTIME</code> after which they cause error <code>%YDB-E-TPTIMEOUT</code>
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        transaction-safed function.
    </ol>


    <h3>See also:</h3>
    <ul>
         <a href="yottadb.html#tp">tp</a>
    </ul>


</dd>
    <dt>
    <a name = "trestart"></a>
    <strong>trestart ()</strong>
    </dt>
    <dd>
    Make the currently running transaction function restart immediately.







</dd>
    <dt>
    <a name = "trollback"></a>
    <strong>trollback ()</strong>
    </dt>
    <dd>
    Make the currently running transaction function rollback immediately and produce a rollback error.







</dd>
</dl>
    <h2 class="section-header "><a name="Node_object_creation"></a>Node object creation </h2>

    <dl class="function">
    <dt>
    <a name = "key"></a>
    <strong>key (varname[, subsarray])</strong>
    </dt>
    <dd>
    Deprecated object that represents a YDB node.  <br/>
 <a href="yottadb.html#key">key</a> is the same as <a href="yottadb.html#node">node</a> except that it retains
 deprecated property names as follows for backward compatibility: <br/>
   * <a href="yottadb.html#node:name">name</a> (this node's subscript or variable name) <br/>
   * <code>value</code> (this node's value in the YottaDB database) <br/>
   * <a href="yottadb.html#data">data</a> (see data()) <br/>
   * <a href="yottadb.html#node:has_value">has_value</a> (whether or not this node has a value) <br/>
   * <a href="yottadb.html#node:has_tree">has_tree</a> (whether or not this node has a subtree) <br/>
 and deprecated defintions of <code>key:subscript()</code>, <code>key:subscript_next()</code>, <code>key:subscript_previous()</code>


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">varname</span>
         String variable name.
        </li>
        <li><span class="parameter">subsarray</span>
         list of subscripts or table {subscripts}
         (<em>optional</em>)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        node
    </ol>


    <h3>See also:</h3>
    <ul>
         <li><a href="yottadb.html#node">node</a></li>
         <li><a href="yottadb.html#data">data</a></li>
    </ul>


</dd>
    <dt>
    <a name = "node"></a>
    <strong>node (varname[, subsarray])</strong>
    </dt>
    <dd>
    Creates and returns a new YottaDB node object.
 This node has all of the class methods defined below.
 Calling the returned node with a string value returns a new node further subscripted by string.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">varname</span>
         String variable name.
        </li>
        <li><span class="parameter">subsarray</span>
         list of subscripts or table {subscripts}
         (<em>optional</em>)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        node
    </ol>



    <h3>Usage:</h3>
    <ul>
        <li><pre class="example">yottadb.node(<span class="string">'varname'</span>)</pre></li>
        <li><pre class="example">yottadb.node(<span class="string">'varname'</span>)(<span class="string">'subscript'</span>)</pre></li>
    </ul>

</dd>
</dl>
    <h2 class="section-header has-description"><a name="Class_node"></a>Class node </h2>

          <div class="section-description">
          Object that represents a YDB node.  </br></br>
 <strong>Note:</strong> Although <code>node:method()</code> is pretty, it is slow. If you are concerned about speed,
 use <code>node:__method()</code> which is equivalent but 15x faster.
 This is because Lua expands <code>node:method()</code> to <code>node.method(node)</code>, so we have to create
 intermediate subnode called <code>node.method</code> and then when it gets called with <code>()</code> we discover
 that its first parameter is of type <a href="yottadb.html#node">node</a> so that we know to invoke <code>node.__method()</code> instead
          </div>
    <dl class="function">
    <dt>
    <a name = "node:delete_node"></a>
    <strong>node:delete_node ()</strong>
    </dt>
    <dd>
    Delete database node pointed to by node object





    <h3>See also:</h3>
    <ul>
         <a href="yottadb.html#delete_node">delete_node</a>
    </ul>


</dd>
    <dt>
    <a name = "node:delete_tree"></a>
    <strong>node:delete_tree ()</strong>
    </dt>
    <dd>
    Delete database tree pointed to by node object





    <h3>See also:</h3>
    <ul>
         <a href="yottadb.html#delete_tree">delete_tree</a>
    </ul>


</dd>
    <dt>
    <a name = "node:get"></a>
    <strong>node:get ([default])</strong>
    </dt>
    <dd>
    Get node's value.
 Equivalent to (but 2.5x slower than) <code>node._</code>


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">default</span>
         return value if the node has no data; if not supplied, nil is the default
         (<em>optional</em>)
        </li>
    </ul>



    <h3>See also:</h3>
    <ul>
         <a href="yottadb.html#get">get</a>
    </ul>


</dd>
    <dt>
    <a name = "node:incr"></a>
    <strong>node:incr (value)</strong>
    </dt>
    <dd>
    Increment node's value


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">value</span>



        </li>
    </ul>



    <h3>See also:</h3>
    <ul>
         <a href="yottadb.html#incr">incr</a>
    </ul>


</dd>
    <dt>
    <a name = "node:lock"></a>
    <strong>node:lock (timeout)</strong>
    </dt>
    <dd>
    Releases all locks held and attempts to acquire a lock matching this node, waiting if requested.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">timeout</span>



        </li>
    </ul>



    <h3>See also:</h3>
    <ul>
         <a href="yottadb.html#lock">lock</a>
    </ul>


</dd>
    <dt>
    <a name = "node:lock_decr"></a>
    <strong>node:lock_decr ()</strong>
    </dt>
    <dd>
    Decrements a lock matching this node, releasing it if possible.





    <h3>See also:</h3>
    <ul>
         <a href="yottadb.html#lock_decr">lock_decr</a>
    </ul>


</dd>
    <dt>
    <a name = "node:lock_incr"></a>
    <strong>node:lock_incr (timeout)</strong>
    </dt>
    <dd>
    Attempts to acquire or increment a lock matching this node, waiting if requested.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">timeout</span>



        </li>
    </ul>



    <h3>See also:</h3>
    <ul>
         <a href="yottadb.html#lock_incr">lock_incr</a>
    </ul>


</dd>
    <dt>
    <a name = "node:set"></a>
    <strong>node:set (value)</strong>
    </dt>
    <dd>
    Set node's value.
 Equivalent to (but 4x slower than) <code>node._ = x</code>


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">value</span>



        </li>
    </ul>



    <h3>See also:</h3>
    <ul>
         <a href="yottadb.html#set">set</a>
    </ul>


</dd>
    <dt>
    <a name = "node:subscripts"></a>
    <strong>node:subscripts ([reverse])</strong>
    </dt>
    <dd>
    Return iterator over the child subscripts of a node (in M terms, collate from "" to "").
 Unlike the deprecated <code>key:subscripts()</code>, <code>node:subscripts()</code> returns all <em>child</em> subscripts, not all subsequent subscripts in the same level.
 Note that subscripts() order is guaranteed to equal the M collation sequence order.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">reverse</span>
         set to true to iterate in reverse order
         (<em>optional</em>)
        </li>
    </ul>




    <h3>Usage:</h3>
    <ul>
        <pre class="example"><span class="keyword">for</span> subscript <span class="keyword">in</span> node:subscripts() <span class="keyword">do</span> ...</pre>
    </ul>

</dd>
</dl>
    <h2 class="section-header "><a name="Get_node_properties"></a>Get node properties </h2>

    <dl class="function">
    <dt>
    <a name = "node:data"></a>
    <strong>node:data ()</strong>
    </dt>
    <dd>
    Fetch the 'data' flags of the node @see data







</dd>
    <dt>
    <a name = "node:has_tree"></a>
    <strong>node:has_tree ()</strong>
    </dt>
    <dd>
    Return true if the node has a tree; otherwise false







</dd>
    <dt>
    <a name = "node:has_value"></a>
    <strong>node:has_value ()</strong>
    </dt>
    <dd>
    Return true if the node has a value; otherwise false







</dd>
    <dt>
    <a name = "node:name"></a>
    <strong>node:name ()</strong>
    </dt>
    <dd>
    Fetch the name of the node, i.e.  the rightmost subscript







</dd>
</dl>
    <h2 class="section-header has-description"><a name="Class_key"></a>Class key </h2>

          <div class="section-description">
          Deprecated object that represents a YDB node.
          </div>
    <dl class="function">
    <dt>
    <a name = "key.property"></a>
    <strong>key.property</strong>
    </dt>
    <dd>
    Properties of key object


    <h3>Fields:</h3>
    <ul>
        <li><span class="parameter">name</span>
         equivalent to <code>node:name()</code>
        </li>
        <li><span class="parameter">data</span>
         equivalent to <code>node:data()</code>
        </li>
        <li><span class="parameter">has_value</span>
         equivalent to <code>node:has_value()</code>
        </li>
        <li><span class="parameter">has_tree</span>
         equivalent to <code>node:has_tree()</code>
        </li>
        <li><span class="parameter">value</span>
         equivalent to <code>node._</code>
        </li>
    </ul>





</dd>
    <dt>
    <a name = "key:subscript_next"></a>
    <strong>key:subscript_next ([reset])</strong>
    </dt>
    <dd>

<p>Deprecated way to get next subscript.
 Deprecated because:</p>

<ul>
    <li>it keeps dangerous state in the object: causes bugs where old references to it think it's still original</li>
    <li>it is more Lua-esque to iterate all subscripts in the node (think table) using pairs()</li>
    <li>if this is a common use-case, it should be reimplemented for node:subscript_next() by
      returning a fresh node object (after node efficiency improvement to avoid subsarray duplication)</li>
</ul>



    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">reset</span>
         If <code>true</code>, resets to the original subscript before any calls to subscript<em>next()
   or subscript</em>previous()
         (<em>optional</em>)
        </li>
    </ul>



    <h3>See also:</h3>
    <ul>
         <li><a href="https://www.lua.org/manual/5.1/manual.html#pdf-pairs">pairs</a></li>
         <li><a href="yottadb.html#subscript_next">subscript_next</a></li>
    </ul>


</dd>
    <dt>
    <a name = "key:subscript_previous"></a>
    <strong>key:subscript_previous ([reset])</strong>
    </dt>
    <dd>
    Deprecated way to get previous subscript.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">reset</span>
         If <code>true</code>, resets to the original subscript before any calls to subscript<em>next()
   or subscript</em>previous()
         (<em>optional</em>)
        </li>
    </ul>



    <h3>See also:</h3>
    <ul>
         <li><a href="yottadb.html#key:subscript_previous">key:subscript_previous</a></li>
         <li><a href="https://www.lua.org/manual/5.1/manual.html#pdf-pairs">pairs</a></li>
    </ul>


</dd>
    <dt>
    <a name = "key:subscripts"></a>
    <strong>key:subscripts ([reverse])</strong>
    </dt>
    <dd>

<p>Deprecated way to get same-level subscripts from this node onward.
 Deprecated because:</p>

<ul>
    <li>pairs() is more Lua-esque</li>
    <li>it was is non-intuitive that k:subscripts() iterates only subsequent subscripts, not all child subscripts</li>
</ul>



    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">reverse</span>
         boolean
         (<em>optional</em>)
        </li>
    </ul>



    <h3>See also:</h3>
    <ul>
         <a href="yottadb.html#subscripts">subscripts</a>
    </ul>


</dd>
</dl>


</div> <!-- id="content" -->
</div> <!-- id="main" -->
<div id="about">
<i>generated by <a href="http://github.com/stevedonovan/LDoc">LDoc 1.4.6</a></i>
<i style="float:right;">Last updated 2022-12-09 21:29:48 </i>
</div> <!-- id="about" -->
</div> <!-- id="container" -->
</body>
</html>
